# LinkPrompt
Implementation of paper "Linkprompt: Natural and Universal Adversarial Attacks on Prompt-based Language Models" on the main conference of NAACL 2024.

![image](misc/main%20illustration.png)

## Overview
We develop $\textit{LinkPrompt}$, an adversarial attack algorithm to generate universal adversarial triggers (UATs) by a gradient-based beam search algorithm that not only effectively attacks the target pre-trained language models (PLMs) and prompt-based fine-tuning models (PFMs) but also maintains the naturalness among the trigger tokens. 

We formulate a combined objective function that includes both an attack objective and a semantic objective. The objective $\mathcal{L}$_${adv}$ is designed to minimize the probability of the [$\texttt{mask}$] token being correctly predicted by the PLM. The semantic objective $\mathcal{L}$_${sem}$ is to maximize the probability of the current candidate token given the previous tokens.

Extensive results demonstrate the effectiveness of $\textit{LinkPrompt}$, as well as the transferability of UATs generated by $\textit{LinkPrompt}$ to Llama2 and GPT-3.5-turbo.

## Setup
$\textit{LinkPrompt}$ is implemented on Python 3.9.18. To install all dependencies, please get into this directory and run the following command:
```
git clone https://github.com/SavannahXu79/LinkPrompt.git
cd LinkPrompt
pip install -r requirements.txt
```

## Usage
`linkprompt.py` implements the trigger search of length 5 on the RoBERTa-large model. 
### command
```
python linkprompt.py  --alpha 0.05 --trigger_length 5
```
To search for position-sensitive triggers, you can change `--trigger_pos` to
